ws.onmessage=(e=>{var t=JSON.parse(e.data);if("score"==t.type)localGame[`${t.team}Score`]+=t.pts,document.getElementById("centerTop").textContent=`${localGame.awayScore} - ${localGame.homeScore}`,"away"==t.team?document.getElementsByClassName("updateScore")[0].textContent=localGame.awayScore:document.getElementsByClassName("updateScore")[1].textContent=localGame.homeScore,document.getElementById("gamesAwayScore")&&(document.getElementById("gamesAwayScore").textContent=localGame.awayScore,document.getElementById("deskAwayScore").textContent=localGame.awayScore,document.getElementById("mobileAwayScore").textContent=localGame.awayScore,document.getElementById("gamesHomeScore").textContent=localGame.homeScore,document.getElementById("deskHomeScore").textContent=localGame.homeScore,document.getElementById("mobileHomeScore").textContent=localGame.homeScore);else if("stopClock"==t.type)stopClock();else if("startClock"==t.type)setTimeout(()=>{startClock(t.s)},20);else if("poss"==t.type)"away"==t.team?(document.getElementsByClassName("ball")[0].style.display="block",document.getElementsByClassName("ball")[1].style.display="none",document.getElementsByClassName("updateBall")[0].style.display="block",document.getElementsByClassName("updateBall")[1].style.display="none"):(document.getElementsByClassName("ball")[1].style.display="block",document.getElementsByClassName("ball")[0].style.display="none",document.getElementsByClassName("updateBall")[1].style.display="block",document.getElementsByClassName("updateBall")[0].style.display="none");else if("down"==t.type)t.conv?(document.getElementById("centerDown").textContent="2PT ATTEMPT",document.getElementById("updateDown").textContent="2PT ATTEMPT"):(document.getElementById("centerDown").textContent=`${ordinal(t.down).toUpperCase()} & ${toGo(t.los,t.toGo)} AT ${los(t.los,t.off,t.def)}`,document.getElementById("updateDown").textContent=`${ordinal(t.down).toUpperCase()} & ${toGo(t.los,t.toGo)} AT ${los(t.los,t.off,t.def)}`);else if("update"==t.type)newUpdate(t);else if("newPeriod"==t.type)localGame.q=t.q,localGame.q<5?(document.getElementById("centerBot").textContent=`${period(localGame.q)} ${decodeEntities("&bull;")} 15:00`,document.getElementById("updateTime").textContent=`${period(localGame.q)} ${decodeEntities("&bull;")} 15:00`):(localGame.s=1/0,document.getElementById("centerBot").textContent=period(localGame.q),document.getElementById("updateTime").textContent=period(localGame.q));else if("teamStats"==t.type)updateTeamStats(t.as,t.hs);else if("final"==t.type)document.getElementById("centerBot").textContent="FINAL",document.getElementById("updateTime").textContent="FINAL";else if("stats"==t.type)updatePlayers(t.players);else if("newGame"==t.type){if(localGame)return location.reload(),!1;resetField(t.game)}});var localGame,clockInt=!1,playerStats={};function showUpdates(){document.getElementById("updateCont").style.display="block",document.body.style.overflowY="hidden"}function hideUpdates(){document.getElementById("updateCont").style.display="none",document.body.style.overflowY="auto"}function resetField(e){document.getElementsByClassName("updatePage")[0].innerHTML="";for(let e of document.getElementsByClassName("playerRow"))e.remove();for(let t=0,o="away";t<2;t++,o="home"){let l=e[o],a=l.mascot.toLowerCase().replace(/\s/g,"");document.getElementsByClassName("topOuter")[t].classList.add(a),document.getElementsByClassName("topRecord")[t].classList.add(a),document.getElementsByClassName("updateLeft")[t].classList.add(a),document.getElementsByClassName("updateScore")[t].classList.add(a),document.getElementsByClassName("updateLogo")[t].classList.add(a);for(let e of document.getElementsByClassName("statsBar"))e.children[t].classList.add(a);document.getElementsByClassName("updateLeft")[t].textContent=l.abbr,document.getElementsByClassName("topRecord")[t].textContent=`(${l.w}-${l.l}) | (${l.dw}-${l.dl})`,0==t?document.getElementById("topLeft").classList.add(a):document.getElementById("botRight").classList.add(a),e.off==o?(document.getElementsByClassName("ball")[t].style.display="block",document.getElementsByClassName("updateBall")[t].style.display="block"):(document.getElementsByClassName("ball")[t].style.display="none",document.getElementsByClassName("updateBall")[t].style.display="none"),document.getElementsByClassName("topOuter")[t].textContent=l.abbr,document.getElementsByClassName("topLogo")[t].src=`logos/${a}_t.png`,document.getElementsByClassName("updateLogo")[t].src=`logos/${a}_t.png`,document.getElementsByClassName("updateScore")[t].textContent=e[`${o}Score`];for(let e of l.fieldPlayers){let t;if(!(t=["WR","TE"].includes(e.pos)?document.getElementById("recCont"):["DL","LB"].includes(e.pos)?document.getElementById("lnCont"):["CB","S"].includes(e.pos)?document.getElementById("dbCont"):document.getElementById(`${e.pos.toLowerCase()}Cont`)))continue;let o=buildElem("DIV","playerRow",void 0,t);o.id=`row${e.id}`,buildElem("IMG",void 0,`logos/${getAttrFromAbbr("clean",e.team)}.png`,o),buildElem("DIV",void 0,void 0,o).innerHTML=`${e.fName} ${e.lName} <span class="num">#${e.id}</span>`;for(let t of playerStats[e.pos])buildElem("DIV",void 0,renderStat(t,e),o)}}document.getElementById("centerTop").textContent=`${e.awayScore} - ${e.homeScore}`;var t=Math.floor(e.s/10),o=Math.floor(t/60),l=t%60;if(l=l<10?`0${l}`:l,document.getElementById("centerBot").textContent=`${period(e.q)} ${decodeEntities("&bull;")} ${o}:${l}`,document.getElementById("updateTime").textContent=`${period(e.q)} ${decodeEntities("&bull;")} ${o}:${l}`,e.los<50)var a=`${e[e.off].abbr} ${e.los}`;else if(e.los>50)a=`${e[e.def].abbr} ${100-e.los}`;else a=50;document.getElementById("centerDown").textContent=`${ordinal(e.down).toUpperCase()} & ${toGo(e.los,e.toGo)} AT ${a}`,document.getElementById("updateDown").textContent=`${ordinal(e.down).toUpperCase()} & ${toGo(e.los,e.toGo)} AT ${a}`,localGame=e,startClock();for(let t of e.plays)newUpdate(t);updateTeamStats(e.away.s,e.home.s)}function updateTeamStats(e,t){let o=["off","def","yds","passYds","rushYds","ypp","firstDowns","sacks","int"],l=document.getElementsByClassName("statsRow");for(let a=0,s=l[0],n=o[0];a<o.length;s=l[++a],n=o[a]){let o,l;"off"==n?(o=calcOffRating(e.plays,e.td,e.pts,e.yds),l=calcOffRating(t.plays,t.td,t.pts,t.yds)):"def"==n?(o=calcDefRating(e.defPlays,e.sacks,e.int,e.allowTd,e.defYds,e.allowPts),l=calcDefRating(t.defPlays,t.sacks,t.int,t.allowTd,t.defYds,t.allowPts)):"ypp"==n?(o=0==e.plays?"0.0":(e.yds/e.plays).toFixed(1),l=0==t.plays?"0.0":(t.yds/t.plays).toFixed(1)):(o=e[n],l=t[n]),s.children[0].textContent=o,s.children[2].textContent=l,o<0?(l-=o,o=0):l<0&&(o-=l,l=0),document.getElementsByClassName("statsBar")[a].children[0].style.width=0==o&&0==l?"calc(50% - 6px)":`calc(${Number(o)/(Number(o)+Number(l))*100}% - 6px)`}}function startClock(e){(!1!==clockInt||e<0)&&clearInterval(clockInt),null!=e&&(localGame.s=e),clockInt=setInterval(()=>{localGame.s--;var e,t=Math.floor(localGame.s/10);if(t<=0)clearInterval(clockInt),4==localGame.q?e="END OF REG":(e=`END ${period(localGame.q)}`,2==localGame.q&&setTimeout(()=>{e="HALFTIME"},1e4));else{var o=Math.floor(t/60),l=t%60;l=l<10?`0${l}`:l,e=localGame.q<5?`${period(localGame.q)} ${decodeEntities("&bull;")} ${o}:${l}`:period(localGame.q)}document.getElementById("centerBot").textContent=e,document.getElementById("updateTime").textContent=e,document.getElementById("gamesTime")&&(document.getElementById("gamesTime").textContent=e)},100)}function stopClock(){clearInterval(clockInt),clockInt=!1}function newUpdate(e){let t=document.createElement("DIV");t.classList.add("updateRow");var o=Math.floor(e.s/10),l=Math.floor(o/60),a=o%60;a=a<10?`0${a}`:a,!0===e.conv?buildElem("DIV","updateRowTop",`${period(e.q)} ${decodeEntities("&bull;")} 2PT ATTEMPT`,t):!1===e.use?e.q<5?buildElem("DIV","updateRowTop",`${period(e.q)} ${l}:${a}`,t):buildElem("DIV","updateRowTop",period(e.q),t):e.q<5?buildElem("DIV","updateRowTop",`${period(e.q)} ${l}:${a} ${decodeEntities("&bull;")} ${ordinal(e.down).toUpperCase()} & ${toGo(e.los,e.toGo)} AT ${los(e.los,e.off,e.def)}`,t):buildElem("DIV","updateRowTop",`${period(e.q)} ${decodeEntities("&bull;")} ${ordinal(e.down).toUpperCase()} & ${toGo(e.los,e.toGo)} AT ${los(e.los,e.off,e.def)}`,t),document.getElementsByClassName("updatePage")[0].prepend(t);let s=buildElem("DIV","updateRowBot",void 0,t),n=buildElem("DIV","updateRowLogo",void 0,s);buildElem("IMG",void 0,`logos/${localGame[e.side].mascot.toLowerCase().replace(/\s/g,"")}.png`,n),buildElem("DIV","updateRowText",e.txt,s)}function los(e,t,o){return e<50?`${localGame[t].abbr} ${e}`:e>50?`${localGame[o].abbr} ${100-e}`:50}function toGo(e,t){return e+t>=100?"GOAL":t}function period(e){return e<5?ordinal(e).toUpperCase():5==e?"OT":`${e-4}OT`}function updatePlayers(e){for(let t of e){if(!t)continue;let e=document.getElementById(`row${t.id}`);if(e)for(let o=2;o<e.children.length;o++)e.children[o].textContent=renderStat(playerStats[t.pos][o-2],t)}}function renderStat(e,t){return"qbr"==e?calcQBRating(t.s.comp,t.s.att,t.s.yds,t.s.td,t.s.int):"c/a"==e?`${t.s.comp}/${t.s.att}`:"t/i"==e?`${t.s.td}/${t.s.int}`:"avg"==e?0==t.s.att?"0.0":(t.s.yds/t.s.att).toFixed(1):"u40"==e?`${t.s.under40}/${t.s.under40Att}`:"o40"==e?`${t.s.over40}/${t.s.over40Att}`:"pat"==e?`${t.s.pat}/${t.s.patAtt}`:t.s[e]}playerStats.QB=["qbr","c/a","t/i","yds"],playerStats.RB=["yds","att","avg","td"],playerStats.WR=["yds","att","avg","td"],playerStats.TE=["yds","att","avg","td"],playerStats.OL=["sacks","holding","defended"],playerStats.DL=["tackles","sacks"],playerStats.LB=["tackles","sacks"],playerStats.CB=["tackles","int","targets"],playerStats.S=["tackles","int","targets"],playerStats.K=["u40","o40","pat","pts"],playerStats.P=["yds","netYds","in20","blocked"];