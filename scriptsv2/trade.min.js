function makeTrade(){document.getElementById("tradeMain").style.display="flex",document.getElementById("tradeCont").style.overflowY="hidden",document.getElementById("tradeMake").style.display="none"}function getAssets(e){var t={method:"getAssets",to:e,from:document.body.getAttribute("data-abbr")};ws.mail(t)}var counterId;function handleAssets(e){document.getElementsByClassName("tradeDesc")[0].textContent=`${getAttrFromAbbr("mascot",e.from)} get`,document.getElementsByClassName("tradeDesc")[1].textContent=`${getAttrFromAbbr("mascot",e.to)} get`,document.getElementById("tradeOptLeft").innerHTML="",document.getElementById("tradeOptRight").innerHTML="",loopPlayers(e.fromAssets.players,"Right"),loopPlayers(e.toAssets.players,"Left"),loopPicks(e.fromAssets.picks,"Right"),loopPicks(e.toAssets.picks,"Left")}function loopPlayers(e,t){for(let n of e){let e=buildElem("label","container",`${n.fName} ${n.lName} (${n.pos} #${n.id})`,document.getElementById(`tradeOpt${t}`)),d=document.createElement("INPUT");d.setAttribute("type","checkbox"),d.setAttribute("name",t.toLowerCase()),d.setAttribute("data-type","player"),d.setAttribute("data-id",n.id),e.append(d),buildElem("span","checkmark",void 0,e)}}function loopPicks(e,t){for(let n of e){let e=buildElem("label","container",`RD ${Math.floor(n.pick/40)+1} PK ${n.pick%40+1} (${ordinal(n.pick+1)} overall)`,document.getElementById(`tradeOpt${t}`)),d=document.createElement("INPUT");d.setAttribute("type","checkbox"),d.setAttribute("name",t.toLowerCase()),d.setAttribute("data-type","pick"),d.setAttribute("data-pick",n.pick),e.append(d),buildElem("span","checkmark",void 0,e)}}function offerTrade(){if(""==document.getElementById("tradeSel").value)return error("Select trade partner");var e=[],t=[];for(let e of document.getElementsByName("left"))e.checked&&t.push({type:e.getAttribute("data-type"),pick:Number(e.getAttribute("data-pick")),id:e.getAttribute("data-id")});for(let t of document.getElementsByName("right"))t.checked&&e.push({type:t.getAttribute("data-type"),pick:Number(t.getAttribute("data-pick")),id:t.getAttribute("data-id")});if(0==e.length||0==t.length)return error("Both teams must get something");ws.mail({method:"offerTrade",to:document.getElementById("tradeSel").value,fromOffer:e,toOffer:t,counterId:counterId}),document.getElementById("tradeMain").style.display="none",document.getElementById("tradeCont").style.overflowY="",counterTo=void 0,counterId=void 0}function renderTrade(e){let t=document.createElement("DIV");t.className="tradeRow",document.getElementById("tradeCont").prepend(t),t.setAttribute("data-id",e.id);let n=buildElem("DIV","tradeTop",void 0,t);buildElem("IMG","tradeLogo",`logos/${getAttrFromAbbr("clean",e.from)}_g.png`,n),buildElem("DIV","tradeTopText",decodeEntities(`${e.from} &#9654; ${e.to}`),n),buildElem("IMG","tradeLogo",`logos/${getAttrFromAbbr("clean",e.to)}_g.png`,n),buildElem("DIV","tradeTopText",decodeEntities(` | ${getFormatTime(e.time,!0)} &middot; ${e.status.toUpperCase()}`),n);let d=buildElem("SVG",void 0,"0 0 24 24",n);d.setAttribute("role","button"),d.addEventListener("click",function(){this.parentElement.nextElementSibling.classList.toggle("show")}),buildElem("TITLE",void 0,"Show Details",d),buildElem("PATH",void 0,"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",d);let r=buildElem("SVG","delete","0 0 24 24",n);r.addEventListener("click",function(){hideTrade(this)}),r.setAttribute("role","button"),buildElem("TITLE",void 0,"Hide Trade",r),buildElem("PATH",void 0,"M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z",r);let o=buildElem("DIV","tradeBot",void 0,t),l=buildElem("DIV","tradeTable",void 0,o);for(let t of e.fromOffer.concat(e.toOffer))"player"==t.type?t.text=`${t.ath.fName} ${t.ath.lName} <span class="num">(${t.ath.pos} #${t.ath.id})</span>`:t.text=`RD ${Math.floor(t.pick/40)+1} PK ${t.pick%40+1} <span class="num">(${ordinal(t.pick+1)} Overall)</span>`;if(e.toOffer.length!=e.fromOffer.length)if(e.toOffer.length>e.fromOffer.length)for(;e.toOffer.length!=e.fromOffer.length;)e.fromOffer.push({text:""});else if(e.toOffer.length<e.fromOffer.length)for(;e.toOffer.length!=e.fromOffer.length;)e.toOffer.push({text:""});e.fromOffer.unshift({text:`${getAttrFromAbbr("mascot",e.to)} Get`}),e.toOffer.unshift({text:`${getAttrFromAbbr("mascot",e.from)} Get`});for(let t=0;t<e.toOffer.length;t++){let n=document.createElement("DIV");n.className="tradeCell",n.innerHTML=e.toOffer[t].text,l.append(n);let d=document.createElement("DIV");d.className="tradeCell",d.innerHTML=e.fromOffer[t].text,l.append(d)}let a=buildElem("DIV","tradeActionCont",void 0,o);if(buildElem("BUTTON",["tradeAction","discuss"],"Discuss",a).addEventListener("click",function(){discussTrade(this)}),e.from==document.body.getAttribute("data-abbr")){buildElem("BUTTON",["tradeAction","retract"],"Retract",a).addEventListener("click",function(){retractTrade(this)})}else{buildElem("BUTTON",["tradeAction","accept"],"Accept",a).addEventListener("click",function(){this.parentElement.style.display="none",this.parentElement.nextElementSibling.style.display="flex"}),buildElem("BUTTON",["tradeAction","counter"],"Counter",a).addEventListener("click",function(){counterTrade(this)}),buildElem("BUTTON",["tradeAction","decline"],"Decline",a).addEventListener("click",function(){declineTrade(this)});let t=buildElem("DIV","tradeActionCont",void 0,o);t.style.display="none",buildElem("BUTTON",["tradeAction","cancel"],"Cancel",t).addEventListener("click",function(){this.parentElement.style.display="none",this.parentElement.previousElementSibling.style.display="flex"}),buildElem("BUTTON",["tradeAction","confirm"],"Confirm",t).addEventListener("click",function(){confirmTrade(this,e.fromTeam)})}buildElem("SPAN","tradeId",`ID: ${e.id}`,o)}function discussTrade(e){let t=e.parentElement.parentElement.previousElementSibling.children[1].textContent,n=e.parentElement.parentElement.parentElement.getAttribute("data-id"),d=t.substring(0,3),r=t.substring(t.length-3,t.length),o=document.body.getAttribute("data-abbr")==d?r:d;document.getElementById("tradeCont").style.display="none",document.getElementById("chatCont").style.display="block",document.getElementById("tradeBtn").style.textDecoration="none",document.getElementById("chatBtn").style.textDecoration="underline",showChat(o),document.getElementById("chatBox").value=`I wanted to talk to you about a trade (ID ${n}).`}function retractTrade(e){ws.mail({method:"retractTrade",id:e.parentElement.parentElement.parentElement.getAttribute("data-id")})}function counterTrade(e,t){counterTo=t,counterId=e.parentElement.parentElement.parentElement.getAttribute("data-id"),offerToTeam(t)}function declineTrade(e){ws.mail({method:"declineTrade",id:e.parentElement.parentElement.parentElement.getAttribute("data-id")})}function confirmTrade(e){ws.mail({method:"acceptTrade",id:e.parentElement.parentElement.parentElement.getAttribute("data-id")})}function offerToTeam(e){document.getElementById("tradeCont").style.overflowY="hidden",document.getElementById("tradeMain").style.display="flex",document.getElementById("tradeSel").value=e,ws.mail({method:"getAssets",to:e,from:document.body.getAttribute("data-abbr")})}function updateTrade(e){for(let t of document.getElementsByClassName("tradeRow"))if(t.getAttribute("data-id")==e.id){for(t.children[0].children[3].textContent=decodeEntities(` | ${getFormatTime(e.time,!0)} &middot; ${e.status}`);t.children[1].children[1].classList.contains("tradeActionCont");)t.children[1].children[1].remove();break}}function hideTrade(e){var t=e.parentElement.parentElement;ws.mail({method:"hideTrade",id:t.getAttribute("data-id")}),t.remove()}function closeTradeWindow(e){counterTo=void 0,counterId=void 0,e.parentElement.parentElement.parentElement.style.display="none",document.getElementById("tradeCont").style.overflowY="",document.getElementById("tradeMake").style.display="flex"}