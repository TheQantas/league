var pinnedPlayers=[],clock=20,clockInt=!1,songs=[4],mute=!1;function updatePicks(e){for(let t of e){let e=document.getElementById(`pick${t.pick}`),n=`${JSON.parse(t.trades)[0]} `;for(let e=1;e<JSON.parse(t.trades).length;e++)n+=`&#9654;&nbsp;${JSON.parse(t.trades)[e]}`;n=decodeEntities(n),e.children[2].textContent=n,e.children[0].src=`/logos/${getAttrFromAbbr("clean",t.team)}_g.png`,document.getElementById(`slide${t.pick}`)&&(document.getElementById(`slide${t.pick}`).textContent=`${t.pick+1}. ${t.team}`)}}function changeDraftStyle(e){var t=getAttrFromAbbr("clean",e);document.getElementById("pickLogo").src=`logos/${t}_c.png`,document.getElementById("pickLogoCont").style.backgroundImage=`url('../logos/${t}.png')`,document.getElementById("footTop").className=t,document.getElementById("pickText").textContent=`${getAttrFromAbbr("mascot",e)} are on the clock`,document.getElementById("homeCont").className=t,document.getElementById("announceCont").className=t,document.getElementById("homeLogo").src=`logos/${t}_t.png`}function breaking(e){document.getElementById("breaking").style.display="block",document.getElementById("bn").style.letterSpacing="5px";var t=0,n=setInterval(()=>{t+=.5,document.getElementById("bn").style.letterSpacing=`${5+t}px`,5==t&&(clearInterval(n),breaking_call(e))},50)}function breaking_call(e){document.getElementById("tx").style.display="block";var t=document.getElementById("bn"),n=document.getElementById("tx");t.style.left=`${t.offsetLeft}px`,t.style.position="absolute",n.style.position="absolute",n.style.left=`${t.offsetLeft+t.offsetWidth}px`,n.style.display="block",n.textContent="- "+e;var o=0,l=t.offsetLeft,a=t.offsetLeft+t.offsetWidth,d=setInterval(()=>{o+=3,t.style.left=`${l-o}px`,n.style.left=`${a-o}px`,n.offsetLeft+n.offsetWidth<=0&&(clearInterval(d),setTimeout(()=>{t.style.position="relative",n.style.position="relative",n.style.left="",t.style.left="",document.getElementById("breaking").style.display="none",document.getElementById("tx").style.display="none"},500))},25)}function pin(e){var t=e.parentElement.parentElement,n=document.getElementsByClassName("playerPage")[11].children;for(let e=2;e<n.length;e++)if(n[e].getAttribute("data-id")==t.getAttribute("data-id"))return;var o=t.cloneNode(!0);o.setAttribute("draggable",!0),o.ondrag=drag,o.ondragend=drop,o.querySelector(".pin").onclick="",o.querySelector(".pin").addEventListener("click",function(){unpin(this)}),o.querySelector(".pin").children[0].setAttribute("d","M2,5.27L3.28,4L20,20.72L18.73,22L12.8,16.07V22H11.2V16H6V14L8,12V11.27L2,5.27M16,12L18,14V16H17.82L8,6.18V4H7V2H17V4H16V12Z"),o.querySelector(".pin").children[1].textContent="Unpin Player",document.getElementsByClassName("playerPage")[11].append(o),updateList()}function unpin(e){e.parentElement.parentElement.remove(),updateList()}function updateList(){pinnedPlayers.length=0;var e=document.getElementsByClassName("playerPage")[11].children;for(let t=2;t<e.length;t++)pinnedPlayers.push(e[t].getAttribute("data-id"));document.cookie=`pinned=${JSON.stringify(pinnedPlayers)}`}function drag(e){const t=e.target,n=t.parentNode,o=event.clientX,l=event.clientY;let a=null===document.elementFromPoint(o,l)?t:document.elementFromPoint(o,l);n===a.parentNode&&(a=a!==t.nextSibling?a:a.nextSibling,n.insertBefore(t,a))}function drop(){updateList()}function startClock(){!1===clockInt&&(c=clock<10?`0${clock}`:clock,document.getElementById("pickClock").textContent=`0:${c}`,clockInt=setInterval(()=>{clock--,c=clock<10?`0${clock}`:clock,document.getElementById("pickClock").textContent=`0:${c}`,0==clock&&stopClock()},1e3))}function stopClock(){clearInterval(clockInt),clockInt=!1}function draftPlayer(e){ws.mail({method:"draftPlayer",id:e.parentElement.parentElement.getAttribute("data-id")})}function announcePick(e){if(document.getElementById("announceCont").children[0].style.letterSpacing="5px",document.getElementById("announceCont").children[1].style.letterSpacing="5px",!mute)var t=0,n=setInterval(()=>{t++,music.volume=1-.1*t,8==t&&clearInterval(n)},20);for(let t=0;t<3;t++)document.getElementsByClassName("rightRow")[t].textContent=e.three[t];audio.play(),stopClock(),document.getElementById("pickText").textContent="the pick is in",document.getElementById("homeCont").style.display="none",document.getElementById("announceCont").style.display="block",document.getElementById("announceCont").children[0].textContent=getAttrFromAbbr("mascot",e.team).toUpperCase();var o=5,l=setInterval(()=>{if(o+=.5,document.getElementById("announceCont").children[0].style.letterSpacing=`${o}px`,document.getElementById("announceCont").children[1].style.letterSpacing=`${o}px`,30==o){clearInterval(l),document.getElementById("announceCont").style.display="none",document.getElementById("silhFName").textContent=e.player.fName,document.getElementById("silhLName").textContent=e.player.lName,document.getElementById("silhPos").textContent=e.player.pos,e.auto?document.getElementById("silhId").textContent=`#${e.player.id}*`:document.getElementById("silhId").textContent=`#${e.player.id}`,document.getElementById("silhCont").style.display="flex",document.getElementById(`pick${e.pick}`).children[3].innerHTML=`${e.player.fName} ${e.player.lName} <span class="num">(${e.player.pos} #${e.player.id})</span>`;for(let t of document.getElementsByClassName("playerRow"))t.getAttribute("data-id")==e.player.id&&t.remove();setTimeout(()=>{clock=e.pick>=159?15:20,startClock();let t=getAttrFromAbbr("clean",e.next);if(document.getElementById("homeCont").style.display="block",document.getElementById("homeCont").className=t,document.getElementById("announceCont").className=t,document.getElementById("silhCont").className=t,document.getElementById("homeLogo").src=`logos/${t}_t.png`,changeDraftStyle(e.next),document.getElementById("footBot").children[1].remove(),"LEA"!=e.soon){buildElem("DIV","footBotCell",`${e.pick+21}. ${e.soon}`,document.getElementById("footBot")).id=`slide${e.pick+20}`}else{buildElem("DIV","footBotCell","-------",document.getElementById("footBot")).style.color="var(--main)"}if(document.getElementById("silhCont").style.display="none",e.pick<319?(document.getElementsByClassName("pickCell")[2].textContent=Math.floor((e.pick+1)/40)+1,document.getElementsByClassName("pickCell")[3].textContent=(e.pick+1)%40+1):(document.getElementsByClassName("pickCell")[2].textContent="-",document.getElementsByClassName("pickCell")[3].textContent="-"),!mute)var n=0,o=setInterval(()=>{n++,music.volume=.2+.1*n,8==n&&clearInterval(o)},20)},2500)}},40)}function newSong(){for(var e=Math.floor(11*Math.random());songs.includes(e);)e=Math.floor(11*Math.random());songs.length>=8&&songs.shift(),songs.push(e),music.src=`audio/music/song${e}.mp3`,music.play()}function toggleMusic(){var e=document.getElementById("songToggle");mute?(music.volume=1,e.children[0].textContent="Mute Music",e.children[1].setAttribute("d","M12,4L9.91,6.09L12,8.18M4.27,3L3,4.27L7.73,9H3V15H7L12,20V13.27L16.25,17.53C15.58,18.04 14.83,18.46 14,18.7V20.77C15.38,20.45 16.63,19.82 17.68,18.96L19.73,21L21,19.73L12,10.73M19,12C19,12.94 18.8,13.82 18.46,14.64L19.97,16.15C20.62,14.91 21,13.5 21,12C21,7.72 18,4.14 14,3.23V5.29C16.89,6.15 19,8.83 19,12M16.5,12C16.5,10.23 15.5,8.71 14,7.97V10.18L16.45,12.63C16.5,12.43 16.5,12.21 16.5,12Z")):(music.volume=0,e.children[0].textContent="Unmute Music",e.children[1].setAttribute("d","M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z")),mute=!mute}ws.onmessage=(e=>{var t=JSON.parse(e.data);if("gottenAssets"==t.method)handleAssets(t);else if("tradeOffered"==t.method)t.to==document.body.getAttribute("data-abbr")&&error("You have a new trade offer!"),newTrade=t.trade,renderTrade(t.trade);else if("tradeUpdate"==t.method)updateTrade(t);else if("gottenChannel"==t.method)loadChannel(t.chats);else if("postedMessage"==t.method)newMessage(t);else if("error"==t.method)error(t.text);else if("getPinned"==t.method)ws.mail({method:"gottenPinned",pinned:getCookie("pinned")});else if("draftedPlayer"==t.method)announcePick(t);else if("draftStarted"==t.method){music.play(),startClock();let e=getAttrFromAbbr("clean",t.team);document.getElementById("homeCont").className=e,document.getElementById("announceCont").className=e,document.getElementById("silhCont").className=e,document.getElementById("homeLogo").src=`logos/${e}_t.png`,document.getElementsByClassName("pickCell")[2].textContent=1,document.getElementsByClassName("pickCell")[3].textContent=1,changeDraftStyle(t.team);for(let e=0;e<3;e++)document.getElementsByClassName("rightRow")[e].textContent=t.three[e]}else"endOfDraft"==t.method?setTimeout(()=>{window.location.href="/office"},20*Math.random()*1e3):"breaking"==t.method?breaking(t.text):"updatePicks"==t.method&&updatePicks(t.picks)}),ws.onopen=(()=>{ws.mail({method:"connectAsTeam",needed:!1})}),window.onload=(()=>{var e=document.getElementsByClassName("playerPage")[11].children;for(let t=2;t<e.length;t++)e[t].setAttribute("draggable",!0),e[t].ondrag=drag,e[t].ondragend=drop;document.getElementById("chatMain")&&document.getElementById("chatMain").addEventListener("keydown",function(e){var t=window.event?event:e;13==t.keyCode&&t.ctrlKey&&post()}),audio=document.getElementById("audio"),music=document.getElementById("music"),music.onended=newSong,clock=Number(document.getElementById("pickClock").getAttribute("data-time")),"true"==document.getElementById("pickClock").getAttribute("data-started")&&(startClock(),setTimeout(()=>{music.play()},1500))});